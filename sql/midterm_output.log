mysql: [Warning] Using a password on the command line interface can be insecure.

============================================================================

FITDB MIDTERM DEMO

============================================================================



1. DATABASE OBJECTS
Reference
See sql/helpers/03_core_tables.sql for all table definitions
Reference
See sql/helpers/07_indexes.sql for all index definitions



2. ACCESS CONTROL
Reference
See sql/helpers/01_roles.sql for all 8 role definitions
Reference
See sql/helpers/02_users.sql for user and grant definitions



3. STORED PROCEDURES
Reference
See sql/helpers/09_procedures.sql for all 3 procedure implementations
Users_Before
1016
User_ID	Member_ID	Card_ID	Message
1017	1001	801	Account created successfully. User ID: 1017, Member ID: 1001, Access Card ID: 801
Users_After
1017



4. VIEWS
Reference
See sql/helpers/08_views.sql for all 7 view implementations



5. QUERY PERFORMANCE WITH EXPLAIN
Test
STAGE 1: No indexes (baseline)
id	select_type	table	partitions	type	possible_keys	key	key_len	ref	rows	filtered	Extra
1	SIMPLE	u	NULL	ALL	NULL	NULL	NULL	NULL	1016	33.33	Using where; Using filesort
Finding
STAGE 1 Results: type=ALL, rows=1016 - must scan all 1016 users and sort in memory (expensive)
Test
STAGE 2: Single-column index on last_login_at
id	select_type	table	partitions	type	possible_keys	key	key_len	ref	rows	filtered	Extra
1	SIMPLE	u	NULL	range	idx_user_last_login	idx_user_last_login	9	NULL	820	100.00	Using index condition; Backward index scan
Finding
STAGE 2 Results: type=range, rows=820, key=idx_user_last_login (BETTER) - index eliminates filesort, only examines ~820 recent logins
Test
STAGE 3: Composite index (last_login_at, status_id)
id	select_type	table	partitions	type	possible_keys	key	key_len	ref	rows	filtered	Extra
1	SIMPLE	u	NULL	range	idx_user_status,idx_user_login_status	idx_user_login_status	17	NULL	820	85.04	Using index condition; Backward index scan
Finding
STAGE 3 Results: type=range, rows=820, filtered=85%, key=idx_user_login_status (BEST) - composite index filters BOTH columns: 820 rows * 85% = ~697 actual rows - without composite index, would need to check status_id on all 820 rows

Performance Gains:
Summary
  Stage 1: Scans 1016 rows + expensive sort operation
Summary
  Stage 2: Scans 820 rows + no sort (eliminates filesort)
Summary
  Stage 3: Scans 820 but filters to ~697 rows efficiently
Summary
  Improvement: ~40% fewer rows examined in Stage 3 vs Stage 2



6. DATA INITIALIZATION
Reference
See data/generate_seed.py for seed data generation script
Reference
See sql/bulkcopy.sql for bulk loading implementation



7. AUDIT STRATEGY

------------------------------------------------------------
Status
Audit tables created:
TABLE_NAME
ACCESS_CARD_AUD
ADMIN_AUD
BOOKING_AUD
CHECK_IN_AUD
CLASS_SESSION_AUD
Status
Audit records BEFORE email update:
seq_no	action	occurred_at
1017	insert	2025-11-05 20:27:20.727547
Status
Performing UPDATE to generate audit record:
ERROR 1048 (23000) at line 139: Column 'email' cannot be null
